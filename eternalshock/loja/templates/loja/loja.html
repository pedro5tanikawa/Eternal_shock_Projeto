{% extends "global/base.html" %}

{% block formulario %}
<main class="loja-main">
  <h1>{{ title }}</h1>
  <p>Total de produtos: {{ produtos|length }}</p>
  <section class="produtos-grid">
    {% if produtos %}
      {% for produto in produtos %}
      <div class="produto-card">
        <div class="produto-imagem">
          {% if produto.imagem %}
            <img src="{{ produto.imagem.url }}" alt="{{ produto.nome }}" title="{{ produto.nome }}">
          {% else %}
            <img src="/static/global/img/placeholder.jpg" alt="Sem imagem">
          {% endif %}
        </div>
        <div class="produto-info">
          <h3 class="produto-nome">{{ produto.nome }}</h3>
          <p class="produto-categoria">
            <span class="badge">{{ produto.get_categoria_display }}</span>
          </p>
          <p class="produto-descricao">{{ produto.descricao|truncatewords:15 }}</p>
          <div class="produto-footer">
            <span class="produto-preco">R$ {{ produto.preco }}</span>
            <span class="produto-estoque">
              {% if produto.estoque > 0 %}
                <span class="em-estoque">Em estoque ({{ produto.estoque }})</span>
              {% else %}
                <span class="fora-estoque">Fora de estoque</span>
              {% endif %}
            </span>
          </div>
          <div class="produto-acoes">
            <a href="{% url 'loja:detalhes' produto.id %}" class="btn-detalhes">Ver Detalhes</a>
            {% if produto.estoque > 0 %}
              <button class="btn-carrinho" onclick="adicionarAoCarrinho({{ produto.id }})">
                Adicionar ao Carrinho
              </button>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <div class="nenhum-produto">
        <p>Nenhum produto encontrado nesta categoria.</p>
      </div>
    {% endif %}
  </section>
</main>
{% endblock formulario %}

  <style>
    .btn-detalhes,
    .btn-carrinho {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
      text-align: center;
      text-decoration: none;
      display: inline-block;
    }

    .btn-detalhes {
      background: #007bff;
      color: white;
    }

    .btn-detalhes:hover {
      background: #0056b3;
    }

    .btn-carrinho {
      background: #28a745;
      color: white;
    }

    .btn-carrinho:hover {
      background: #218838;
    }

    .nenhum-produto {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px 20px;
      color: #999;
      font-size: 1.1em;
    }

    .produto-imagem img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      transition: transform 0.3s;
      display: block;
    }

    @media (max-width: 768px) {
      .loja-header h1 {
        font-size: 1.8em;
      }

      .produtos-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }

      .produto-acoes {
        flex-direction: column;
      }

      .btn-detalhes,
      .btn-carrinho {
        width: 100%;
      }
    }
  </style>

  <script>
    function adicionarAoCarrinho(produtoId) {
      console.log('Adicionando produto ' + produtoId + ' ao carrinho');
      // Você pode implementar a lógica aqui
    }
  </script>

