{% extends "global/base.html" %}

{% block formulario %}
<main class="perfil-main">
  <section class="perfil-section">
    <div class="perfil-header">
      <div class="foto-perfil-container">
        {% if pessoa.foto_perfil %}
          <img src="{{ pessoa.foto_perfil.url }}" alt="Foto de {{ pessoa.nome }}" class="foto-perfil">
        {% else %}
          <div class="foto-perfil-placeholder">
            <i class="bi bi-person-circle"></i>
          </div>
        {% endif %}
      </div>
      <div class="info-perfil">
        <h1>{{ pessoa.nome }}</h1>
        <p class="usuario"><strong>Usuário:</strong> {{ request.user.username }}</p>
        <p class="email"><strong>Email:</strong> {{ pessoa.email }}</p>
        <p class="idade"><strong>Idade:</strong> {{ pessoa.idade }} anos</p>
        <a href="{% url 'cadastro:editar_perfil' %}" class="btn-editar">
          <i class="bi bi-pencil-square"></i> Editar Perfil
        </a>
      </div>
    </div>

    <hr class="divisor">

    <div class="favoritos-section">
      <h2>Meus Relógios Favoritos</h2>
      
      {% if favoritos %}
        <div class="favoritos-grid">
          {% for produto in favoritos %}
            <div class="favorito-card">
              {% if produto.imagem %}
                <img src="{{ produto.imagem.url }}" alt="{{ produto.nome }}" class="favorito-imagem">
              {% else %}
                <div class="favorito-imagem-placeholder">
                  <i class="bi bi-image"></i>
                </div>
              {% endif %}
              <div class="favorito-info">
                <h3>{{ produto.nome }}</h3>
                <p class="descricao">{{ produto.descricao|truncatewords:20 }}</p>
                <p class="preco">R$ {{ produto.preco }}</p>
                <div class="favorito-acoes">
                  <a href="{% url 'loja:detalhes' produto.id %}" class="btn-ver">Ver Detalhes</a>
                  <form method="post" action="{% url 'cadastro:remover_favorito' produto.id %}" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn-remover">
                      <i class="bi bi-heart-fill"></i> Remover
                    </button>
                  </form>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="sem-favoritos">
          <p>Você ainda não tem relógios nos favoritos.</p>
          <a href="{% url 'loja:index' %}" class="btn-explorar">Explorar Relógios</a>
        </div>
      {% endif %}
    </div>
  </section>
</main>
{% endblock formulario %}
